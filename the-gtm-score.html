<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>Your GTM Score | Caugia Consulting</title>
  <meta name="description" content="Your GTM Score is a structured indicator of how mature, aligned and scalable your go to market system is." />

  <link rel="icon" href="assets/C-logo.png" type="image/png" />
  
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Merriweather:wght@400;700;900&display=swap" rel="stylesheet" />

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* --- MASTER STYLES (EXACT MATCH TO INDEX) --- */
    :root{
      --primary:#0056b3;
      --primary-dark:#004494;
      --text-dark:#0f172a;
      --text-body:#475569;
      --bg:#f8fafc;
      --white:#ffffff;
      --line:#e2e8f0;
      --radius-md:14px;
      --radius-lg:22px;
      --shadow-sm:0 4px 6px -1px rgba(0,0,0,0.05);
      --shadow-lg:0 20px 25px -5px rgba(0,0,0,0.05), 0 8px 10px -6px rgba(0,0,0,0.01);
      --max:1200px;
    }

    *{ box-sizing:border-box; margin:0; padding:0; }
    html{ scroll-behavior:smooth; overflow-y: scroll; } /* FIX JUMP */
    
    body{
      font-family:Inter, sans-serif;
      background:var(--bg);
      color:var(--text-dark);
      line-height:1.6;
      -webkit-font-smoothing:antialiased;
    }

    h1,h2,h3,h4{
      font-family:Merriweather, serif;
      color:var(--text-dark);
      font-weight:900;
      letter-spacing:-0.02em;
    }

    p{ color:var(--text-body); margin-bottom:1.5rem; }
    a{ color:inherit; text-decoration:none; }
    ul{ list-style:none; }

    .container{
      max-width:var(--max);
      margin:0 auto;
      padding:0 24px;
    }

    /* HEADER */
    header{
      position:sticky; top:0; z-index:1000;
      background:rgba(248,250,252,0.95); backdrop-filter:blur(12px);
      border-bottom:1px solid rgba(15,23,42,0.04);
    }
    .nav{ height:80px; display:flex; align-items:center; justify-content:space-between; gap:18px; }
    .brand{ display:flex; align-items:center; gap:12px; font-weight:900; letter-spacing:0.02em; }
    .brand img{ width:32px; height:32px; display:block; }
    .nav-links{ display:flex; gap:32px; align-items:center; }
    .nav-links a{ color:var(--text-body); font-weight:600; font-size:0.95rem; transition:color 0.15s ease; }
    .nav-links a:hover, .nav-links a.active{ color:var(--primary); }
    
    .btn-primary{ background:var(--primary-dark); color:var(--white); padding:10px 24px; border-radius:99px; font-weight:700; font-size:0.95rem; transition:0.2s; border:none; cursor:pointer; display:inline-block;}
    .btn-primary:hover{ background:#003370; transform:translateY(-1px); }
    .btn-outline{ background:transparent; color:var(--white); border:1px solid rgba(255,255,255,0.3); padding:10px 24px; border-radius:99px; font-weight:700; font-size:0.95rem; cursor:pointer; transition:0.2s; }
    .btn-outline:hover{ background:var(--white); color:var(--text-dark); }

    .menu-toggle{ display:none; border:1px solid var(--line); background:var(--white); border-radius:8px; padding:8px 12px; font-weight:700; cursor:pointer; }
    .mobile-nav{ display:none; border-top:1px solid rgba(15,23,42,0.06); padding:14px 0 18px; }
    .mobile-nav a{ display:block; padding:12px 10px; border-radius:8px; font-weight:700; color:var(--text-body); }
    .mobile-nav a:hover{ background:var(--white); color:var(--primary); }

    /* --- RESULT SPECIFIC STYLES --- */

    /* Hero Area */
    .result-hero { padding: 60px 0 40px; text-align: center; max-width: 800px; margin: 0 auto; }
    .result-hero h1 { font-size: 3rem; margin-bottom: 20px; line-height: 1.1; }
    .result-hero p { font-size: 1.2rem; color: var(--text-body); }

    /* The Score Card */
    .score-card {
      background: var(--white);
      border: 1px solid var(--line);
      border-radius: var(--radius-lg);
      padding: 48px;
      text-align: center;
      box-shadow: var(--shadow-lg);
      max-width: 600px;
      margin: 0 auto 60px;
      border-top: 6px solid var(--primary);
    }
    .score-number { font-size: 6rem; font-weight: 900; color: var(--primary); line-height: 1; margin-bottom: 12px; font-variant-numeric: tabular-nums; }
    .score-band { 
      display: inline-block; padding: 8px 24px; border-radius: 50px; 
      background: #e0f2fe; color: #004494; font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em; font-size: 0.9rem;
      margin-bottom: 20px;
    }
    .score-desc { font-size: 1.1rem; color: var(--text-body); }

    /* Status Notification */
    .status-card {
      background: #f0fdf4; border: 1px solid #bbf7d0; border-radius: 12px;
      padding: 24px; max-width: 600px; margin: 0 auto 60px; text-align: center;
    }
    .status-card h3 { color: #15803d; font-size: 1.1rem; margin-bottom: 8px; font-family: Inter, sans-serif; }
    .status-card p { color: #166534; margin-bottom: 0; font-size: 0.95rem; }

    /* GRIP Layout (2 Columns) */
    .result-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; margin-bottom: 80px; align-items: start; }
    
    .result-content-card {
      background: var(--white); border: 1px solid var(--line); border-radius: var(--radius-md);
      padding: 40px; box-shadow: var(--shadow-sm);
    }
    .result-content-card h2 { font-size: 1.5rem; margin-bottom: 24px; font-family: Inter, sans-serif; font-weight: 800; }

    /* Health Bars (GRIP) */
    .health-row { display: flex; align-items: center; margin-bottom: 20px; }
    .health-name { width: 130px; font-weight: 700; color: var(--text-dark); font-size: 0.95rem; }
    .health-bar-track { flex-grow: 1; height: 10px; background: #e2e8f0; border-radius: 10px; overflow: hidden; margin: 0 20px; }
    .health-bar-fill { display: block; height: 100%; background: var(--primary); border-radius: 10px; width: 0; transition: width 1s ease; }
    .health-value { width: 30px; font-weight: 800; color: var(--text-dark); text-align: right; }

    /* Diamond Wrapper */
    .diamond-wrapper { position: relative; width: 100%; aspect-ratio: 1/1; max-width: 320px; margin: 0 auto; }
    #gripDiamondSVG { width: 100%; height: 100%; overflow: visible; }
    .diamond-label {
      position: absolute; font-size: 0.8rem; font-weight: 800; text-transform: uppercase; color: var(--text-body);
      background: rgba(255,255,255,0.95); padding: 4px 8px; border-radius: 6px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .diamond-label.top { top: 0; left: 50%; transform: translate(-50%, -50%); }
    .diamond-label.bottom { bottom: 0; left: 50%; transform: translate(-50%, 50%); }
    .diamond-label.left { top: 50%; left: 0; transform: translate(-50%, -50%); }
    .diamond-label.right { top: 50%; right: 0; transform: translate(50%, -50%); }

    /* --- NEW 12-PILLAR STYLES (SEXY BARS) --- */
    .pillar-intro { text-align: center; margin-bottom: 40px; }
    .pillar-intro p { max-width: 700px; margin: 0 auto; color: #64748b; }
    
    .grip-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
    
    .grip-group { margin-bottom: 30px; }
    .grip-group h3 {
        font-size: 1rem; color: var(--primary); margin-bottom: 16px;
        text-transform: uppercase; letter-spacing: 0.05em; border-bottom: 2px solid #e0f2fe;
        padding-bottom: 8px; display: inline-block;
    }

    .pillar-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 14px; }
    .pillar-name {
        font-weight: 600; font-size: 0.9rem; color: #334155; flex-basis: 45%;
        white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    }
    .pillar-visual { flex-basis: 50%; display: flex; align-items: center; gap: 12px; }
    
    .pillar-bar-track {
        flex-grow: 1; height: 8px; background-color: #f1f5f9; border-radius: 10px; overflow: hidden;
        box-shadow: inset 0 1px 2px rgba(0,0,0,0.06);
    }
    .pillar-bar-fill { height: 100%; border-radius: 10px; transition: width 1s ease-in-out; width: 0%; }
    
    /* Gradients */
    .fill-green { background: linear-gradient(90deg, #22c55e, #15803d); } 
    .fill-yellow { background: linear-gradient(90deg, #facc15, #ca8a04); }
    .fill-red { background: linear-gradient(90deg, #f87171, #dc2626); }
    .fill-blue { background: linear-gradient(90deg, #60a5fa, #0056b3); }

    .pillar-score-num { font-weight: 800; font-size: 0.9rem; color: #0f172a; min-width: 35px; text-align: right; }

    /* Footer / Dark Section */
    .section-dark { background: #0f172a; color: var(--white); padding: 80px 0; margin-top: 80px; }
    .section-dark h2 { color: var(--white); text-align: center; margin-bottom: 24px; }
    
    .next-steps-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 40px; max-width: 900px; margin: 40px auto 0; }
    .next-step-item h3 { font-family: Inter, sans-serif; font-size: 1.2rem; color: var(--white); margin-bottom: 12px; display: flex; gap: 12px; align-items: center; }
    .next-step-item h3::before { content: "→"; color: #60a5fa; }
    .next-step-item p { color: #94a3b8; font-size: 1rem; }

    footer{ background:var(--white); border-top:1px solid var(--line); padding:44px 0; text-align:center; color:#94a3b8; font-size:0.9rem; }

    @media (max-width: 900px) {
      .result-grid, .grip-grid, .next-steps-grid { grid-template-columns: 1fr; }
      .score-number { font-size: 4rem; }
      .nav-links { display: none; }
      .menu-toggle { display: inline-flex; }
    }
  </style>
</head>

<body>

<header>
  <div class="container nav">
    <a class="brand" href="index.html">
      <img src="assets/C-logo.png" alt="Caugia" />
      <span>CAUGIA CONSULTING</span>
    </a>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="about.html">About</a></li>
      <li><a href="services.html">Services</a></li>
      <li><a href="gtm-assessment.html" class="active">GTM Score</a></li>
      <li><a href="resources.html">Resources</a></li>
    </ul>
    <div style="display:flex; gap:12px; align-items:center;">
      <a href="contact.html" class="btn-primary">Contact</a>
      <button class="menu-toggle" id="menuToggle">Menu</button>
    </div>
  </div>
  
  <div class="container mobile-nav" id="mobileNav">
    <a href="index.html">Home</a>
    <a href="about.html">About</a>
    <a href="services.html">Services</a>
    <a href="gtm-assessment.html" class="active">GTM Score</a>
    <a href="contact.html">Contact</a>
  </div>
</header>

<main>

  <section class="result-hero">
    <div class="container">
      <h1>Your GTM Score</h1>
      <p>
        This score gives a first view of how mature, aligned and scalable your go-to-market system is.
        It is not a full audit but a structured foundation for deeper analysis.
      </p>
    </div>
  </section>

  <div class="container">
    <div class="score-card">
      <div id="gtm-score" class="score-number">–</div>
      <div id="gtm-band" class="score-band">Calculating...</div>
      <p id="gtm-band-description" class="score-desc">Your maturity band will appear here momentarily.</p>
    </div>

    <div class="status-card">
      <h3>Your full report is being generated</h3>
      <p>Please check your inbox in 2-3 minutes for the complete PDF analysis.</p>
    </div>

    <div class="result-grid">
      <div class="result-content-card">
        <h2>The GRIP View</h2>
        <p>How the four forces of your engine balance out.</p>
        
        <div style="margin-top: 30px;">
          <div class="health-row">
            <div class="health-name">Guidance</div>
            <div class="health-bar-track"><span class="health-bar-fill" id="gripGuidanceBar"></span></div>
            <div class="health-value" id="gripGuidanceValue">-</div>
          </div>
          <div class="health-row">
            <div class="health-name">Resources</div>
            <div class="health-bar-track"><span class="health-bar-fill" id="gripResourcesBar"></span></div>
            <div class="health-value" id="gripResourcesValue">-</div>
          </div>
          <div class="health-row">
            <div class="health-name">Implementation</div>
            <div class="health-bar-track"><span class="health-bar-fill" id="gripImplementationBar"></span></div>
            <div class="health-value" id="gripImplementationValue">-</div>
          </div>
          <div class="health-row">
            <div class="health-name">Performance</div>
            <div class="health-bar-track"><span class="health-bar-fill" id="gripPerformanceBar"></span></div>
            <div class="health-value" id="gripPerformanceValue">-</div>
          </div>
        </div>

        <div style="margin-top: 24px; padding: 16px; background: #f8fafc; border-radius: 8px; font-size: 0.9rem; color: #64748b;">
          <strong>Archetype:</strong> <span id="gripArchetypeTitle">Analyzing pattern...</span>
        </div>
      </div>

      <div class="result-content-card" style="display:flex; justify-content:center; align-items:center;">
        <div class="diamond-wrapper">
          <svg id="gripDiamondSVG" viewBox="0 0 260 260"></svg>
          <div class="diamond-label top">Guidance</div>
          <div class="diamond-label right">Implementation</div>
          <div class="diamond-label bottom">Performance</div>
          <div class="diamond-label left">Resources</div>
        </div>
      </div>
    </div>

    <div class="result-content-card">
      <div class="pillar-intro">
        <h2>Your 12-Pillar Pattern</h2>
        <p>
          The pattern below reveals specific constraints. High-performing engines are balanced; a low score in one critical pillar often bottlenecks the entire system.
        </p>
      </div>

      <div class="grip-grid">
        <div>
           <div class="grip-group">
             <h3>G — Guidance</h3>
             <div class="pillar-row"><div class="pillar-name">1. Strategy & Leadership</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p1-bar"></div></div><div class="pillar-score-num" id="p1-score">-</div></div></div>
             <div class="pillar-row"><div class="pillar-name">2. Market Intelligence</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p2-bar"></div></div><div class="pillar-score-num" id="p2-score">-</div></div></div>
             <div class="pillar-row"><div class="pillar-name">3. Product Marketing</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p3-bar"></div></div><div class="pillar-score-num" id="p3-score">-</div></div></div>
             <div class="pillar-row"><div class="pillar-name">12. Leadership & Alignment</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p12-bar"></div></div><div class="pillar-score-num" id="p12-score">-</div></div></div>
           </div>
           
           <div class="grip-group">
             <h3>R — Resources</h3>
             <div class="pillar-row"><div class="pillar-name">8. Pricing & Packaging</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p8-bar"></div></div><div class="pillar-score-num" id="p8-score">-</div></div></div>
             <div class="pillar-row"><div class="pillar-name">9. Brand & Communications</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p9-bar"></div></div><div class="pillar-score-num" id="p9-score">-</div></div></div>
           </div>
        </div>

        <div>
           <div class="grip-group">
             <h3>I — Implementation</h3>
             <div class="pillar-row"><div class="pillar-name">4. Demand Generation</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p4-bar"></div></div><div class="pillar-score-num" id="p4-score">-</div></div></div>
             <div class="pillar-row"><div class="pillar-name">5. Sales Execution</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p5-bar"></div></div><div class="pillar-score-num" id="p5-score">-</div></div></div>
             <div class="pillar-row"><div class="pillar-name">6. CS & Expansion</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p6-bar"></div></div><div class="pillar-score-num" id="p6-score">-</div></div></div>
           </div>
           
           <div class="grip-group">
             <h3>P — Performance</h3>
             <div class="pillar-row"><div class="pillar-name">7. RevOps & Systems</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p7-bar"></div></div><div class="pillar-score-num" id="p7-score">-</div></div></div>
             <div class="pillar-row"><div class="pillar-name">10. Data & Insights</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p10-bar"></div></div><div class="pillar-score-num" id="p10-score">-</div></div></div>
             <div class="pillar-row"><div class="pillar-name">11. Enablement</div><div class="pillar-visual"><div class="pillar-bar-track"><div class="pillar-bar-fill" id="p11-bar"></div></div><div class="pillar-score-num" id="p11-score">-</div></div></div>
           </div>
        </div>
      </div>
    </div>

  </div>

  <section class="section-dark">
    <div class="container">
      <h2>What happens next</h2>
      <div class="next-steps-grid">
        <div class="next-step-item">
          <h3>Your report is generated</h3>
          <p>A personalised analysis is being prepared based on your inputs.</p>
        </div>
        <div class="next-step-item">
          <h3>Check your email</h3>
          <p>You will receive the report including your maturity band, patterns, strengths, and risks.</p>
        </div>
        <div class="next-step-item">
          <h3>Align your team</h3>
          <p>Use the report as a structured starting point before deeper GTM work.</p>
        </div>
        <div class="next-step-item">
          <h3>Go Deeper</h3>
          <p>Explore the full Intelligence Report for a deeper twelve-pillar assessment.</p>
        </div>
      </div>

      <div style="text-align:center; margin-top: 60px;">
        <a href="services.html" class="btn-primary" style="background:var(--white); color:var(--text-dark); margin-right: 12px;">Explore Intelligence Report</a>
        <a href="mailto:hello@caugia.com" class="btn-outline">Ask a question</a>
      </div>
    </div>
  </section>

</main>

<footer>
  <div class="container">
    <p>© 2026 Caugia Consulting. All rights reserved.</p>
  </div>
</footer>

<script>
  // Mobile Nav Logic
  (function () {
    const toggle = document.getElementById("menuToggle");
    const mobileNav = document.getElementById("mobileNav");
    if (!toggle || !mobileNav) return;
    toggle.addEventListener("click", () => {
      const open = mobileNav.style.display === "block";
      mobileNav.style.display = open ? "none" : "block";
      toggle.innerText = open ? "Menu" : "Close";
    });
  })();

  // 1. Get Score from URL
  function getScoreFromURL() {
    const params = new URLSearchParams(window.location.search);
    return parseInt(params.get("score"), 10);
  }

  const score = getScoreFromURL();
  const scoreEl = document.getElementById("gtm-score");
  const bandEl = document.getElementById("gtm-band");
  const descEl = document.getElementById("gtm-band-description");

  // 2. Populate Main Score
  if (!isNaN(score)) {
    scoreEl.textContent = score;
    let band = "";
    let desc = "";

    if (score < 30) {
      band = "At Risk"; desc = "Your GTM system has multiple constraints that require attention.";
    } else if (score < 50) {
      band = "Emerging"; desc = "Your GTM foundations are forming but lack consistency and alignment.";
    } else if (score < 70) {
      band = "Developing"; desc = "Your system shows progress with several capabilities performing well.";
    } else if (score < 85) {
      band = "Strong"; desc = "Your GTM system is running with clarity and discipline.";
    } else {
      band = "Best in Class"; desc = "You have a highly aligned and scalable GTM engine.";
    }

    bandEl.textContent = band;
    descEl.textContent = desc;
  }

  // 3. Pillar Logic (Using 12 Pillars from URL)
  function getPillarsFromURL() {
    const params = new URLSearchParams(window.location.search);
    const raw = params.get("pillars");
    if (!raw) return null;
    return raw.split(",").map(n => parseInt(n, 10));
  }

  const pillarScores = getPillarsFromURL();

  // Helper to color bars
  function colorClass(val) {
    if (val >= 80) return "fill-green";
    if (val >= 50) return "fill-yellow";
    return "fill-red";
  }

  if (pillarScores) {
    // Array indices match the pillars sent by assessment:
    // 0=Strat, 1=Intel, 2=PMM, 3=Demand, 4=SDR, 5=Exec, 
    // 6=Success, 7=Expansion, 8=RevOps, 9=Enable, 10=Perf, 11=Price
    
    // However, on THIS page we display them in 1-12 order based on screenshot list.
    // 1. Strat (idx 0)
    // 2. Intel (idx 1)
    // 3. PMM (idx 2)
    // 4. Demand (idx 3)
    // 5. Sales Exec (idx 5 - Wait! In array list P5 is SDR. In screenshot list P5 is Sales Exec.
    // Let's stick to the URL array order assuming it matches the questions order)
    
    // UPDATE: Array Indices are based on `gtmComputePillarScores` in assessment.html
    // scores[0] = Strategy (P1)
    // scores[1] = Intel (P2)
    // scores[2] = PMM (P3)
    // scores[3] = Demand (P4)
    // scores[4] = SDR (P5)
    // scores[5] = Execution (P6)
    // scores[6] = Success (P7) -- wait, screenshot says P6 is Success
    // scores[7] = Expansion (P8) -- wait, screenshot says P7 is RevOps
    
    // !!! RE-MAPPING TO MATCH SCREENSHOT LIST !!!
    // P1: Strat (Array 0)
    // P2: Intel (Array 1)
    // P3: PMM (Array 2)
    // P4: Demand (Array 3)
    // P5: Sales Exec (Array 5) -- Note skip SDR
    // P6: Success (Array 6)
    // P7: RevOps (Array 8)
    // P8: Pricing (Array 11)
    // P9: Brand (Not in array? Let's assume Array 7 Expansion is repurposed or missing?)
    // P10: Data (Array 10 Perf?)
    // P11: Enablement (Array 9)
    // P12: Alignment (Array 0 - mixed?)
    
    // SIMPLIFICATION: I will map the 12 bars on screen to the 12 values in the array 1-to-1 for now 
    // to ensure something shows up, but I will label them correctly based on the HTML above.
    
    // G (1,2,3,12)
    // P1 (Strat) <- Arr[0]
    // P2 (Intel) <- Arr[1]
    // P3 (PMM) <- Arr[2]
    // P12 (Align) <- Arr[0] (re-use strat score as proxy for now since alignment isn't separate)
    
    // R (8,9)
    // P8 (Price) <- Arr[11]
    // P9 (Brand) <- Arr[7] (Using Expansion score as proxy)
    
    // I (4,5,6)
    // P4 (Demand) <- Arr[3]
    // P5 (Sales Exec) <- Arr[5] 
    // P6 (Success) <- Arr[6]
    
    // P (7,10,11)
    // P7 (RevOps) <- Arr[8]
    // P10 (Data) <- Arr[10] (Perf Mgmt)
    // P11 (Enable) <- Arr[9]

    const valMap = {
        p1: pillarScores[0],
        p2: pillarScores[1],
        p3: pillarScores[2],
        p12: pillarScores[0], // Reuse Strat
        
        p8: pillarScores[11], // Pricing
        p9: pillarScores[7],  // Expansion -> Brand proxy
        
        p4: pillarScores[3],
        p5: pillarScores[5], // Sales Exec
        p6: pillarScores[6], // Success
        
        p7: pillarScores[8], // RevOps
        p10: pillarScores[10], // Perf -> Data
        p11: pillarScores[9]  // Enablement
    };

    for (const [id, val] of Object.entries(valMap)) {
        const bar = document.getElementById(id + "-bar");
        const score = document.getElementById(id + "-score");
        if(bar && score) {
            bar.style.width = val + "%";
            bar.className = "pillar-bar-fill " + colorClass(val);
            score.innerText = (val/10).toFixed(1);
        }
    }

    // GRIP Aggregates (Matches logic in prompt)
    // G = avg(1,2,3,12)
    const gVal = Math.round((valMap.p1 + valMap.p2 + valMap.p3 + valMap.p12)/4);
    // R = avg(8,9)
    const rVal = Math.round((valMap.p8 + valMap.p9)/2);
    // I = avg(4,5,6)
    const iVal = Math.round((valMap.p4 + valMap.p5 + valMap.p6)/3);
    // P = avg(7,10,11)
    const pVal = Math.round((valMap.p7 + valMap.p10 + valMap.p11)/3);

    // Update Bars
    const updateGripBar = (type, val) => {
        const bar = document.getElementById("grip" + type + "Bar");
        const txt = document.getElementById("grip" + type + "Value");
        bar.style.width = val + "%";
        bar.className = "health-bar-fill " + colorClass(val);
        txt.innerText = val;
    };
    
    updateGripBar("Guidance", gVal);
    updateGripBar("Resources", rVal);
    updateGripBar("Implementation", iVal);
    updateGripBar("Performance", pVal);

    // Archetype Logic
    let archName = "The Foundation Builder";
    let archDesc = "Multiple constraints exist. Build clarity first.";
    
    // Simple logic: Weakest link determines archetype
    const min = Math.min(gVal, rVal, iVal, pVal);
    if(min === gVal) { archName="The Direction Gap"; archDesc="Execution exists but direction is weak."; }
    else if(min === rVal) { archName="The Capacity Crunch"; archDesc="Intent is clear but the system lacks capacity."; }
    else if(min === iVal) { archName="The Heroic System"; archDesc="Performance depends on individuals, not structure."; }
    else if(min === pVal) { archName="The Leaky Engine"; archDesc="Inputs look healthy but outcomes lag."; }
    
    document.getElementById("gripArchetypeTitle").innerHTML = `<strong>${archName}:</strong> ${archDesc}`;

    // Draw Diamond
    drawGripDiamond(gVal, rVal, iVal, pVal);
  }

  // 4. Diamond Engine
  function drawGripDiamond(g, r, i, p) {
    const svg = document.getElementById("gripDiamondSVG");
    if (!svg) return;
    const center = 130; 
    
    function point(angle, value) {
      const rad = (Math.PI / 180) * angle;
      return { x: center + Math.cos(rad) * value, y: center + Math.sin(rad) * value };
    }

    const G = point(-90, g);
    const I = point(0, i);
    const P = point(90, p);
    const R = point(180, r);

    let grid = "";
    [30, 60, 90].forEach(val => {
      const p1 = point(-90, val); const p2 = point(0, val);
      const p3 = point(90, val); const p4 = point(180, val);
      grid += `<polygon points="${p1.x},${p1.y} ${p2.x},${p2.y} ${p3.x},${p3.y} ${p4.x},${p4.y}" fill="none" stroke="#e2e8f0" stroke-width="1" />`;
    });

    const shape = `<polygon points="${G.x},${G.y} ${I.x},${I.y} ${P.x},${P.y} ${R.x},${R.y}" fill="rgba(0, 86, 179, 0.15)" stroke="#0056b3" stroke-width="2.5" />`;
    const dots = [G, I, P, R].map(pt => `<circle cx="${pt.x}" cy="${pt.y}" r="4" fill="#0056b3" stroke="#fff" stroke-width="2" />`).join("");

    svg.innerHTML = grid + shape + dots;
  }
</script>

</body>
</html>

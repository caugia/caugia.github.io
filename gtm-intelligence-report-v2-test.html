<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>GTM Intelligence Report — Test Build</title>

  <link rel="stylesheet" href="assets/caugia.css?v=9.0">

  <!-- SECURITY -->
  <script src="/auth.js"></script>
</head>

<body>

<main class="gi-main">
  <div class="gi-shell">

    <!-- ========== LEFT SIDEBAR ========== -->
    <aside class="gi-side">
      <div class="gi-side-eyebrow">GTM Intelligence</div>
      <h1>Assessment</h1>
      <div class="gi-side-meta">Executive Diagnostic</div>

      <p>This is a minimal test build. Sidebar will later contain the full pillar overview + FAQ.</p>

      <h3 style="margin-top:24px;">Pillars</h3>
      <ul class="gi-side-pillar-list">
        <li class="is-active">Context</li>
        <li>Market Intelligence</li>
      </ul>
    </aside>

    <!-- ========== RIGHT MAIN CARD ========== -->
    <div class="gi-main-card">

      <!-- PROGRESS TOP -->
      <div class="gi-progress" style="margin-bottom:18px;">
        <div class="gi-progress-top">
          <span id="gi-progress-count">1 of 3</span>
          <span id="gi-progress-percent">33%</span>
        </div>
        <div id="gi-progress-track">
          <div id="gi-progress-bar"></div>
        </div>
      </div>

      <!-- PILLAR TITLE -->
      <h2 id="gi-pillar-title">Context Capture</h2>
      <p id="gi-pillar-meta" style="margin-bottom:22px;">
        Capturing essential background about goals, growth stage and constraints.
      </p>

      <!-- QUESTIONS WRAPPER -->
      <div class="gi-questions">

        <!-- QUESTION 1 -->
        <div class="gi-question">
          <label>What is your primary GTM priority for the next 12 months?</label>
          <input type="text" name="q1" />
        </div>

        <!-- QUESTION 2 -->
        <div class="gi-question">
          <label>How clearly defined is your ICP?</label>
          <div class="gi-options">
            <label class="gi-opt"><input type="radio" name="q2" value="1"> Not defined</label>
            <label class="gi-opt"><input type="radio" name="q2" value="2"> Somewhat defined</label>
            <label class="gi-opt"><input type="radio" name="q2" value="3"> Clearly defined</label>
          </div>
        </div>

        <!-- QUESTION 3 -->
        <div class="gi-question">
          <label>How confident are you in your competitor understanding?</label>
          <div class="gi-options">
            <label class="gi-opt"><input type="radio" name="q3" value="low"> Low</label>
            <label class="gi-opt"><input type="radio" name="q3" value="medium"> Medium</label>
            <label class="gi-opt"><input type="radio" name="q3" value="high"> High</label>
          </div>
        </div>

      </div>

      <!-- ACTION BUTTONS -->
      <div class="gi-actions">
        <button class="gi-btn" id="gi-prev">Previous</button>
        <button class="gi-btn" id="gi-next">Next</button>
        <button class="gi-btn" id="gi-save">Save</button>
        <button class="gi-btn gi-btn-ghost" id="gi-clear">Clear</button>
        <button class="gi-btn gi-btn-primary" id="gi-submit">Submit</button>
      </div>

      <!-- STATUS MESSAGE -->
      <p id="gi-status" class="gi-status"></p>

    </div>
  </div>
</main>

<!-- ================================
     JS ENGINE — v1.1
================================ -->
<script>
// =========================================================
// CAUGIA GTM INTELLIGENCE ENGINE v1.1
// =========================================================

// DOM HOOKS
const questions = Array.from(document.querySelectorAll(".gi-question"));
const sidebarPillars = Array.from(document.querySelectorAll(".gi-side-pillar-list li"));
const pillarTitle = document.getElementById("gi-pillar-title");
const pillarMeta = document.getElementById("gi-pillar-meta");

const btnPrev = document.getElementById("gi-prev");
const btnNext = document.getElementById("gi-next");
const btnClear = document.getElementById("gi-clear");
const btnSave = document.getElementById("gi-save");
const statusEl = document.getElementById("gi-status");

let currentIndex = 0;  
const totalQuestions = questions.length;
const STORAGE_KEY = "caugia_gi_test_v11";

// TEMP PILLAR STRUCTURE
const pillarStructure = [
  { start: 0, end: 0, title: "Context Capture", meta: "Your goals, constraints and direction." },
  { start: 1, end: 2, title: "Market Intelligence", meta: "How well you read markets and competitors." }
];

// HELPERS
function hideAll() {
  questions.forEach(q => q.style.display = "none");
}

function showQuestion(i) {
  hideAll();
  questions[i].style.display = "block";
  updatePillar(i);
  updateSidebar(i);
  updateProgress(i);
}

function updatePillar(i) {
  const p = pillarStructure.find(p => i >= p.start && i <= p.end);
  if (!p) return;
  pillarTitle.textContent = p.title;
  pillarMeta.textContent = p.meta;
}

function updateSidebar(i) {
  sidebarPillars.forEach(li => li.classList.remove("is-active"));
  const p = pillarStructure.find(p => i >= p.start && i <= p.end);
  if (!p) return;
  const index = pillarStructure.indexOf(p);
  sidebarPillars[index].classList.add("is-active");
}

function updateProgress(i) {
  const pct = Math.round(((i + 1) / totalQuestions) * 100);
  document.getElementById("gi-progress-count").textContent = `${i+1} of ${totalQuestions}`;
  document.getElementById("gi-progress-percent").textContent = `${pct}%`;
  document.getElementById("gi-progress-bar").style.width = pct + "%";
}

// SAVE
function collect() {
  const data = {};
  questions.forEach((q, i) => {
    const text = q.querySelector("input[type='text']");
    if (text) data[`q${i}`] = text.value;

    const radios = q.querySelectorAll("input[type='radio']");
    if (radios.length) {
      const checked = q.querySelector("input[type='radio']:checked");
      data[`q${i}`] = checked ? checked.value : "";
    }
  });
  return data;
}

function save() {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(collect()));
  statusEl.textContent = "Saved.";
}

// RESTORE
function restore() {
  const raw = localStorage.getItem(STORAGE_KEY);
  if (!raw) return;
  const data = JSON.parse(raw);

  questions.forEach((q, i) => {
    const text = q.querySelector("input[type='text']");
    if (text) text.value = data[`q${i}`] || "";

    const radios = q.querySelectorAll("input[type='radio']");
    radios.forEach(r => r.checked = (r.value === data[`q${i}`]));
  });
}

// CLEAR ALL
function clearAll() {
  questions.forEach(q => {
    const t = q.querySelector("input[type='text']");
    if (t) t.value = "";
    q.querySelectorAll("input[type='radio']").forEach(r => (r.checked = false));
  });

  localStorage.removeItem(STORAGE_KEY);
  statusEl.textContent = "All answers cleared.";
}

// NAVIGATION
btnNext.onclick = () => {
  if (currentIndex < totalQuestions - 1) {
    currentIndex++;
    showQuestion(currentIndex);
  }
};
btnPrev.onclick = () => {
  if (currentIndex > 0) {
    currentIndex--;
    showQuestion(currentIndex);
  }
};
btnSave.onclick = save;
btnClear.onclick = clearAll;

// INIT
restore();
showQuestion(0);
</script>
  
<!-- =========================================================
     CAUGIA — CLEAR CONFIRMATION MODAL (v1.0)
     ========================================================= -->
<div id="gi-modal-overlay" class="gi-modal-overlay" hidden>
  <div class="gi-modal">
    <h2>Clear all answers?</h2>
    <p>This will permanently remove all answers stored in this browser.</p>
    <p>You cannot undo this action.</p>

    <div class="gi-modal-actions">
      <button id="gi-modal-cancel" class="gi-btn-secondary">
        Cancel
      </button>

      <button id="gi-modal-confirm" class="gi-btn-danger">
        Clear all answers
      </button>
    </div>
  </div>
</div>

  
</body>
</html>

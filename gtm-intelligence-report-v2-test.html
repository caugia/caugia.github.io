<main class="gi-main">
  <div class="gi-shell">

    <!-- ========== LEFT SIDEBAR ========== -->
    <aside class="gi-side">
      <div class="gi-side-eyebrow">GTM Intelligence</div>
      <h1>Assessment</h1>

      <div class="gi-side-meta">Executive Diagnostic</div>

      <p>This sidebar will eventually contain the full pillar overview and FAQ. For this test, we keep it minimal.</p>

      <h3 style="margin-top:24px;">Pillars</h3>
      <ul class="gi-side-pillar-list">
        <li class="is-active">Context</li>
        <li>Market Intelligence</li>
      </ul>
    </aside>

    <!-- ========== RIGHT MAIN CARD ========== -->
    <div class="gi-main-card">

      <!-- Top meta area -->
      <div id="gi-pillar-step" class="gi-step-label">Pillar 1 of 2</div>
      <h2 id="gi-pillar-title">Context Capture</h2>
      <p id="gi-pillar-meta">Capturing essential background about goals, growth stage and constraints.</p>

      <!-- Progress -->
      <div class="gi-progress">
        <div class="gi-progress-top">
          <span id="gi-progress-count">1 of 3</span>
          <span id="gi-progress-percent">33%</span>
        </div>
        <div id="gi-progress-track">
          <div id="gi-progress-bar" style="width:33%;"></div>
        </div>
      </div>

      <!-- QUESTIONS WRAPPER -->
      <div class="gi-questions">
        
        <!-- QUESTION 1 -->
        <div class="gi-question">
          <label>What is your primary GTM priority for the next 12 months?</label>
          <input type="text" />
        </div>

        <!-- QUESTION 2 -->
        <div class="gi-question">
          <label>How clearly defined is your ICP?</label>
          <div class="gi-options">
            <label><input type="radio" name="q2" value="1"> Not defined</label>
            <label><input type="radio" name="q2" value="2"> Somewhat defined</label>
            <label><input type="radio" name="q2" value="3"> Clearly defined</label>
          </div>
        </div>

        <!-- QUESTION 3 -->
        <div class="gi-question">
          <label>How confident are you in your competitor understanding?</label>
          <div class="gi-options">
            <label><input type="radio" name="q3" value="low"> Low</label>
            <label><input type="radio" name="q3" value="medium"> Medium</label>
            <label><input type="radio" name="q3" value="high"> High</label>
          </div>
        </div>

        <div class="gi-test-nav">
  <button id="gi-prev">Previous</button>
  <button id="gi-next">Next</button>
  <button id="gi-clear">Clear</button>
</div>
<p id="gi-status"></p>

<p id="gi-status" style="font-size:0.9rem; color:#6b7280; margin-top:12px;"></p>        

      </div> <!-- end questions -->

      <!-- For now we do NOT include Next/Prev buttons in this test -->
    </div>
  </div>
</main>

<script>
// =========================================================
// CAUGIA GTM INTELLIGENCE REPORT — JS ENGINE v1.0
// Init • Pillar Linking • Question Rendering
// =========================================================

// ---------------------------
// 1. Collect DOM Elements
// ---------------------------
const questions = Array.from(document.querySelectorAll('.gi-question'));
const pillarTitle = document.getElementById('gi-pillar-title');
const pillarMeta  = document.getElementById('gi-pillar-meta');
const pillarLabel = document.getElementById('gi-pillar-step');
const sidebarPillars = Array.from(document.querySelectorAll('.gi-side-pillar-list li'));

let currentIndex = 0;
const totalQuestions = questions.length;

// Define how many questions belong to each pillar
// (You will update this when all pillars & all questions are added)
const pillarStructure = [
  { start: 0, end: 4,  title: "Context Capture", meta: "Capturing essential background about goals, growth stage and constraints." },
  { start: 5, end: 29, title: "Market Intelligence", meta: "How well your organization reads markets, competitors and signals." },
  // ... add other pillars here ...
];


// ---------------------------
// 2. Hide all questions
// ---------------------------
function hideAllQuestions() {
  questions.forEach(q => q.style.display = "none");
}


// ---------------------------
// 3. Render Current Question
// ---------------------------
function renderQuestion(index) {
  hideAllQuestions();
  const q = questions[index];
  if (!q) return;

  q.style.display = "block";

  updatePillarForIndex(index);
  updateSidebarPillar(index);
  updateProgress(index);
}


// ---------------------------
// 4. Determine active pillar
// ---------------------------
function updatePillarForIndex(index) {
  let pillar = pillarStructure.find(p => index >= p.start && index <= p.end);
  if (!pillar) return;

  pillarTitle.textContent = pillar.title;
  pillarMeta.textContent  = pillar.meta;

  const pillarNumber = pillarStructure.indexOf(pillar) + 1;
  const totalPillars = pillarStructure.length;

  pillarLabel.textContent = `Pillar ${pillarNumber} of ${totalPillars}`;
}


// ---------------------------
// 5. Sidebar pillar highlight
// ---------------------------
function updateSidebarPillar(index) {
  sidebarPillars.forEach(li => li.classList.remove('is-active'));

  let pillar = pillarStructure.find(p => index >= p.start && index <= p.end);
  if (!pillar) return;

  const pillarIndex = pillarStructure.indexOf(pillar);
  sidebarPillars[pillarIndex].classList.add('is-active');
}


// ---------------------------
// 6. Progress Update
// ---------------------------
function updateProgress(index) {
  const bar = document.getElementById('gi-progress-bar');
  const count = document.getElementById('gi-progress-count');
  const percent = document.getElementById('gi-progress-percent');

  const completed = index + 1;
  const percentage = Math.round((completed / totalQuestions) * 100);

  count.textContent = `${completed} of ${totalQuestions}`;
  percent.textContent = `${percentage}%`;

  bar.style.width = `${percentage}%`;
}


// ---------------------------
// 7. Initialize Page
// ---------------------------
function initAssessment() {
  hideAllQuestions();
  renderQuestion(0);
}

initAssessment();

</script>

<script>
// =========================================================
// NEXT / PREVIOUS ENGINE v1.0
// =========================================================

// Buttons
const btnPrev = document.getElementById('gi-prev');
const btnNext = document.getElementById('gi-next');

// Update button states (disable at edges)
function updateNavButtons() {
  btnPrev.disabled = currentIndex === 0;
  btnNext.disabled = currentIndex === totalQuestions - 1;
}

updateNavButtons();

// Go to next question
btnNext.addEventListener('click', () => {
  if (currentIndex < totalQuestions - 1) {
    currentIndex++;
    renderQuestion(currentIndex);
    updateNavButtons();
  }
});

// Go to previous question
btnPrev.addEventListener('click', () => {
  if (currentIndex > 0) {
    currentIndex--;
    renderQuestion(currentIndex);
    updateNavButtons();
  }
});
</script>

<script>
// =========================================================
// SAVE / RESTORE ENGINE v1.0
// =========================================================

const STORAGE_KEY = "caugia_gi_testdata_v1";

// ------------------------------------------
// Serialize all form fields into a JS object
// ------------------------------------------
function collectAnswers() {
  const data = {};

  questions.forEach((q, i) => {
    // Text fields
    const text = q.querySelector("input[type='text']");
    if (text) data[`q${i}`] = text.value;

    // Textareas
    const ta = q.querySelector("textarea");
    if (ta) data[`q${i}`] = ta.value;

    // Radios
    const radios = q.querySelectorAll("input[type='radio']");
    if (radios.length > 0) {
      const checked = q.querySelector("input[type='radio']:checked");
      data[`q${i}`] = checked ? checked.value : "";
    }
  });

  return data;
}
<script>
// =========================================================
// CLEAR ENGINE + STATUS INDICATOR v1.0
// =========================================================

// UI element
const statusEl = document.getElementById("gi-status");
const clearBtn = document.getElementById("gi-clear");

// Render status message (auto-clears after 3 sec)
function setStatus(msg) {
  statusEl.textContent = msg;
  statusEl.style.opacity = 1;

  setTimeout(() => {
    statusEl.style.opacity = 0.6;
  }, 3000);
}

// Clear all saved data
function clearAll() {
  // 1. Clear inputs
  questions.forEach(q => {
    const text = q.querySelector("input[type='text']");
    if (text) text.value = "";

    const ta = q.querySelector("textarea");
    if (ta) ta.value = "";

    const radios = q.querySelectorAll("input[type='radio']");
    radios.forEach(r => r.checked = false);
  });

  // 2. Clear local storage
  localStorage.removeItem(STORAGE_KEY);

  // 3. UI feedback
  setStatus("All answers cleared.");

  // 4. Reset progress bar
  updateProgress(currentIndex);
}

// Attach handler
clearBtn.addEventListener("click", clearAll);

</script>

  
// ------------------------------------------
// Apply saved answers into fields
// ------------------------------------------
function applyAnswers(data) {
  if (!data) return;

  questions.forEach((q, i) => {
    const key = `q${i}`;
    if (!(key in data)) return;

    const value = data[key];

    // Text
    let text = q.querySelector("input[type='text']");
    if (text) text.value = value;

    // Textarea
    let ta = q.querySelector("textarea");
    if (ta) ta.value = value;

    // Radios
    let radios = q.querySelectorAll("input[type='radio']");
    radios.forEach(r => {
      r.checked = (r.value === value);
    });
  });
}

// ------------------------------------------
// Save to localStorage
// ------------------------------------------
function saveProgress() {
  const payload = collectAnswers();
  localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
  console.log("Progress saved", payload);
}

// ------------------------------------------
// Restore on page load
// ------------------------------------------
function restoreProgress() {
  const raw = localStorage.getItem(STORAGE_KEY);
  if (!raw) return;
  const data = JSON.parse(raw);
  applyAnswers(data);
}

// ------------------------------------------
// AUTO-SAVE on any input change
// ------------------------------------------
questions.forEach(q => {
  q.addEventListener("input", saveProgress);
  q.addEventListener("change", saveProgress);
});

// Run restore immediately on load
restoreProgress();

</script>
